<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Modal default</title>
  <link href="https://fonts.googleapis.com/css?family=Exo+2" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>

    <div class="container">
        <h1>Создание уже и не такого простого модального окошка!</h1>

        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nam fuga sunt voluptas, ullam, sed consequuntur ab illo veniam ad totam alias voluptatibus sequi officiis, unde autem reiciendis magnam labore voluptatum?</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nam fuga sunt voluptas, ullam, sed consequuntur ab illo veniam ad totam alias voluptatibus sequi officiis, unde autem reiciendis magnam labore voluptatum?</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nam fuga sunt voluptas, ullam, sed consequuntur ab illo veniam ad totam alias voluptatibus sequi officiis, unde autem reiciendis magnam labore voluptatum?</p>
        <p class="btn"><a href="#" id="modal-open" class="modal-open" title="Покажите мне модальное окошко">Открыть окно</a></p>

        <div class="modal-data"></div>
        <p class="btn"><a href="#" id="clear-data" class="clear-data hide">Очистить данные</a></p>






       <a href="#" data-supermodal="NewModel" data-supermodal-title="EX1" data-supermodal-content="Your open first Modal">Example1</a>

        <div id="NewModel" class="modal modal_closed">
          <h2>ПРИМЕР ПЕРВЫЙ</h2>
          <p id="Your open first Modal">ЕСТЬ ВСЕ АТТРИБУТЫ, НО НЕТ ВЕРСТКИ ПОД НИХ</p>
        </div>




        <a href="#" data-supermodal="NewModel1" data-supermodal-title="EX2" data-supermodal-content="Your open second Modal">Example2</a>

        <div id="NewModel1" class="modal modal_closed">
          <h2 id="EX2">ПРИМЕР 2</h2>
          <p id="Your open second Modal">ЕСТЬ ВСЕ АТТРИБУТЫ И ВСЯ ВЕРСТКА ПОД НИХ</p>
        </div>




        <a href="#" data-supermodal="NewModel2">Example3</a>

        <div id="NewModel2" class="modal modal_closed">

            <h2>ПРИМЕР ТРЕТИЙ</h2>
            <p>НЕТ АТТРИБУТОВ TITLE и CONTENT</p>

        </div>


         


    </div>





    <div class="modal-overlay modal_closed" id="modal-overlay"></div>
    <div class="modal modal_closed" id="modal">
        <header class="modal__header">
            <a href="#" class="modal__close" id="modal-close" title="Закрыть модальное окно">Закрыть</a>
            <h2>Введите данные</h2>
        </header>

        <main class="modal__content">
            <div class="form-field">
                <label for="name">Ваше имя:</label>
                <input required class="input__default" type="text" id="name" name="name">
            </div>
            <div class="form-field">
                <label>Ваш день рождения:</label>
                <input required type="number" class="input__date-birth" id="birth-day" name="birth-day" placeholder="День"> -
                <input required type="number" class="input__date-birth" id="birth-month" name="birth-month" placeholder="Месяц"> -
                <input required type="number" class="input__date-birth" id="birth-year" name="birth-year" placeholder="Год">
            </div>
        </main>

        <footer class="modal__footer">
            <button id="modal-cancel" class="modal__cancel" title="Отмена">Отмена</button>
            <button id="modal-save" class="modal__save" title="Сохранить">Сохранить данные</button>
        </footer>

    </div>



<script>
  /* ----- modal init module --- */
  const MyPlugin = (function () {
  /* ------- begin view -------- */
    function ModalView() {
      let myModal = null;
      let myModalOverlay = null;
      /*
      const modalData = document.querySelector(".modal-data");
      const clearBtn = document.querySelector("#clear-data");
      let saveBtn = null;
*/
      this.init = function(modal, modalOverlay) {
        myModal = modal;
        myModalOverlay = modalOverlay || document.querySelector("#modal-overlay");
        //saveBtn = myModal.querySelector("#modal-save");
      }

      this.show = function() {
    
        myModal.classList.remove("modal_closed");
        myModalOverlay.classList.remove("modal_closed");
      }

      this.hide = function() {
        myModal.classList.add("modal_closed");
        myModalOverlay.classList.add("modal_closed");
      }

      this.setDataFromAttributes = function(title, content){
          let titleView = document.getElementById(title);
          let contentView = document.getElementById(content);
         

            if(titleView&&contentView){
              titleView.textContent = title;
              contentView.textContent = content;
            }  else {
              let h1 = document.createElement('h1');
              h1.textContent = title;
              myModal.append(h1);
               let p = document.createElement('p');
              p.textContent = content;
              myModal.append(p);
            }
      }
/**
      this.clearForm = function() {
        const inputs = myModal.querySelectorAll("input");
        for (let item of inputs) {
          item.value = "";
        }
      }

      this.printViewData = function(data) {
        modalData.innerHTML = `<h3>Привет, ${data.name}!!!</h3><p>Да у тебя ДР ${data.birthDay}/${data.birthMonth}/${data.birthYear}.</p>`;
        clearBtn.classList.remove("hide");
      }

      this.clearViewData = function() {
        modalData.innerHTML = "Данные отсутствуют...";
        clearBtn.classList.add("hide");
      }

      this.disableSaveBtn = function(state) {
        saveBtn.disabled = state;
      }

      this.printError = function(erorr = "Error!") {
        console.error(erorr);
      }

      this.printInfo = function(msg = "") {
        console.info(msg);
      }
*/
      

    };

  /* -------- end view --------- */
  /* ------- begin model ------- */
    function ModalModel () {
      let myModalContainer = null;
      let myModalView = null;

     // this.btnDisableState = true;

      this.init = function(modalView) {
        myModalContainer = modal;
        myModalView = modalView;
        //this.showData();
      }

      this.openModal = function() {
        //myModalView.disableSaveBtn(this.btnDisableState);
        myModalView.show();
      }

      this.setDataFromAttributes = function(title, content){
        myModalView.setDataFromAttributes(title, content);
      }

      this.closeModal = function() {
        //this.clearForm();
        myModalView.hide();
      }
/*
      this.saveModalData = function(data) {
        if (data) {
          this.storeData(data);
          myModalView.printViewData(data);
        } else {
          myModalView.clearViewData();
          myModalView.printError("Nothing to save!");
        }

        this.clearForm();
        myModalView.hide();
      }

      this.checkInputs = function(data) {
        btnDisableState = Object.values(data).some(value => value === "");
        myModalView.disableSaveBtn(btnDisableState);
      }

      this.showData = function() {
        const data = this.getData();
        data ? myModalView.printViewData(data) : myModalView.printInfo("Nothing to display!");
      }

      this.storeData = function(userData) {
        if (typeof localStorage !== "undefined") {
          localStorage.setItem("userData", JSON.stringify(userData));
        } else {
          myModalView.printError("localStorage is not defined and you can try to use cookies");
        }
      }

      this.getData = function() {
        if (typeof localStorage !== "undefined") {
          return (JSON.parse(localStorage.getItem("userData")));
        } else {
          myModalView.printError("localStorage is not defined and you can try to use cookies");
          return false;
        }
      }

      this.clearData = function() {
        if (typeof localStorage !== "undefined") {
          localStorage.removeItem("userData");
          myModalView.clearViewData();
          myModalView.printInfo("Data removed...");
        } else {
          myModalView.printError("localStorage is not defined and you can try to use cookies");
        }
      }

      this.clearForm = function() {
        myModalView.clearForm();
        this.btnDisableState = true;
      }
*/


    }
  /* -------- end model -------- */
  /* ----- begin controller ---- */
    function ModalController () {
      let myModalContainer = null;
      let myModalModel = null;
      let myModalBtn = null;
      let closeButton = null;

      /*
      let cancelButton = null;
      let saveButton = null;
      let openButton = null;
      let modalInputName = null;
      let modalInputDay = null
      let modalInputMonth = null;
      let modalInputYear = null;
*/  
      let title = null;
      let content = null;

      this.init = function(modal, model, modalBtn, attributes) {
        myModalContainer = modal;
        myModalModel = model;
        myModalBtn = modalBtn;
        //console.log(myModalContainer)
        //closeButton = myModalContainer.querySelector("#modal-close");
        //closeButton.addEventListener("click", this.hideModal);

        //cancelButton = myModalContainer.querySelector("#modal-cancel");
        //cancelButton.addEventListener("click", this.hideModal);

        //saveButton = myModalContainer.querySelector("#modal-save");
        //saveButton.addEventListener("click", this.saveModal);

        //console.log(myModalBtn)

        //let allModals = modalBtn.hasAttribute('data-supermodal');
       // console.log(allModals)

       //Вешаем на ссылку обработчик
        myModalBtn.addEventListener("click", this.openModal);


        //создаем кнопку закрыть
        closeButton = document.createElement('a')
        closeButton.innerHTML = "<a href='#' class='modal__close' title='Закрыть модальное окно'></a>";
        myModalContainer.append(closeButton);
        closeButton.addEventListener('click', this.hideModal);

        //Если есть все аттрибуты, отправляем значения title и content
        if(attributes){  
          myModalModel.setDataFromAttributes(modalBtn.dataset.supermodalTitle, modalBtn.dataset.supermodalContent)
        }
    
        
        

        /*

        openButton = document.querySelector("#clear-data");
        openButton.addEventListener("click", this.clearData);

        modalInputName = myModalContainer.querySelector("#name");
        modalInputDay = myModalContainer.querySelector("#birth-day");
        modalInputMonth = myModalContainer.querySelector("#birth-month");
        modalInputYear = myModalContainer.querySelector("#birth-year");

        myModalContainer.addEventListener("input", this.checkInputs);*/
      }

      this.openModal = function(event) {
        event.preventDefault();
        myModalModel.openModal();
      }

      this.hideModal = function(event) {
        event.preventDefault();
        myModalModel.closeModal();
      }
/*
      this.saveModal = function(event) {
        event.preventDefault();
        myModalModel.saveModalData(
          {
            name: modalInputName.value,
            birthDay: modalInputDay.value,
            birthMonth: modalInputMonth.value,
            birthYear: modalInputYear.value,
          }
        );
      }

      this.clearData = function(event) {
        event.preventDefault();
        myModalModel.clearData();
      }

      this.checkInputs = function(event) {
        myModalModel.checkInputs(
          {
            name: modalInputName.value,
            birthDay: modalInputDay.value,
            birthMonth: modalInputMonth.value,
            birthYear: modalInputYear.value,
          }
        );
      }
      */

    }
  /* ------ end controller ----- */
  /* ------ public methods ----- */
    return {
      version: "0.0.1",

      init: function(modalContainer, modalBtn, attributes) {
        this.main();

        const appModalView = new ModalView();
        const appModalModel = new ModalModel();
        const appModalController = new ModalController();

        //связываем части модуля
        appModalView.init(modalContainer);
        appModalModel.init(appModalView);
        appModalController.init(modalContainer, appModalModel, modalBtn, attributes);
      },

      main: function () {
        //предварительно что то можно сделать, например
        console.log(`Modal plugin (v${this.version}) was initialized.`);
      },
    }

  })();
  /* ------ end app module ----- */

  //MyPlugin.init(document.getElementById("modal")); //инициализируем модуль с нужным контейнером



  //Находим все ссылки на модалки по аттрибуту
  let allModals = document.querySelectorAll('[data-supermodal]');


    for(i=0; i<allModals.length; i++){

      let modalId = document.getElementById(allModals[i].dataset.supermodal);

     let checkAttribute1 = allModals[i].hasAttribute('data-supermodal-title');
     let checkAttribute2 = allModals[i].hasAttribute('data-supermodal-content')


     if(checkAttribute1&&checkAttribute2){
            MyPlugin.init(modalId, allModals[i], "hasAttributes");

          } else {
            MyPlugin.init(modalId, allModals[i]);

          }
    }


</script>
</body>
</html>
